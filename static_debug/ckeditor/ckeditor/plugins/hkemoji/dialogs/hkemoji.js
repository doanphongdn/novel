CKEDITOR.dialog.add("hkemojiDialog",function(e){var t,o=e.config,a=function(o){var a=o.data.getTarget(),i=a.getName();if("a"==i)a=a.getChild(0);else if("img"!=i)return;i=a.getAttribute("cke_src"),a=e.document.createElement("img",{attributes:{src:i,"data-cke-saved-src":i,width:a.$.width,height:a.$.height}}),e.insertElement(a),t.hide(),o.data.preventDefault()},i=CKEDITOR.tools.addFunction(function(t,o){var i;t=new CKEDITOR.dom.event(t),o=new CKEDITOR.dom.element(o),i=t.getKeystroke();var r="rtl"==e.lang.dir;switch(i){case 38:(i=o.getParent().getParent().getPrevious())&&(i=i.getChild([o.getParent().getIndex(),0])).focus(),t.preventDefault();break;case 40:(i=o.getParent().getParent().getNext())&&(i=i.getChild([o.getParent().getIndex(),0]))&&i.focus(),t.preventDefault();break;case 32:a({data:t}),t.preventDefault();break;case r?37:39:(i=o.getParent().getNext())?((i=i.getChild(0)).focus(),t.preventDefault(!0)):(i=o.getParent().getParent().getNext())&&((i=i.getChild([0,0]))&&i.focus(),t.preventDefault(!0));break;case r?39:37:(i=o.getParent().getPrevious())?((i=i.getChild(0)).focus(),t.preventDefault(!0)):(i=o.getParent().getParent().getPrevious())&&((i=i.getLast().getChild(0)).focus(),t.preventDefault(!0))}}),r=function(e){var t,a=['<div style="max-height:300px;overflow-y:scroll;"><style type="text/css">.hkemoji{border:1pt solid transparent;}.hkemoji:hover {cursor:pointer;border:0 solid;border-color:transparent;background-color:#e6ffff}</style><span id="'+(a=CKEDITOR.tools.getNextId()+"_smiley_emtions_label")+'" class="cke_voice_label">Test</span>','<table role="listbox" aria-labelledby="'+a+'" style="width:100%;height:100%;border-collapse:separate;" cellspacing="2" cellpadding="2"',CKEDITOR.env.ie&&CKEDITOR.env.quirks?' style="position:absolute;"':"","><tbody>"],r={},n=0;for(t in o.hkemoji.emojis[e]){r[s=o.hkemoji.emojis[e][t]]=t}for(t in r)if(0==n%6&&a.push('<tr role="presentation">'),r.hasOwnProperty(t)){var l,s=r[t];for(l in s)s.hasOwnProperty(l);s=o.smiley_path+e+"/"+t,a.push('<td class="cke_centered" style="vertical-align: middle;" role="presentation"><img style="max-width:52px;max-height:52px" class="hkemoji" cke_src="'+CKEDITOR.tools.htmlEncode(s)+'" src="'+s+'" href="javascript:void(0)" onkeydown="CKEDITOR.tools.callFunction( ',i,', event, this );"/>',"</td>"),5==n%6&&a.push("</tr>"),n++}if(5>n){for(;5>n;n++)a.push("<td></td>");a.push("</tr>")}return a.push("</tbody></table></div>"),a},n=function(e){return{type:"html",id:"emojiSelector",html:r(e).join(""),onLoad:function(e){t=e.sender},onClick:a,style:"width: 100%; border-collapse: separate;"}};return{title:"HK Emoji",minWidth:480,minHeight:200,resizable:CKEDITOR.DIALOG_RESIZE_NONE,contents:[{id:"tab-onion",label:e.config.hkemoji.tabs.onion,elements:[n("onion")]},{id:"tab-red",label:e.config.hkemoji.tabs.red,elements:[n("red")]},{id:"tab-milkbottle",label:e.config.hkemoji.tabs.milkbottle,elements:[n("milkbottle")]},{id:"tab-facebook",label:e.config.hkemoji.tabs.facebook,elements:[n("facebook")]}],onShow:function(){}}});